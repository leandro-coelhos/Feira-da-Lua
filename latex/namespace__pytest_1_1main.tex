\doxysection{\+\_\+pytest.\+main Namespace Reference}
\hypertarget{namespace__pytest_1_1main}{}\label{namespace__pytest_1_1main}\index{\_pytest.main@{\_pytest.main}}
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{class__pytest_1_1main_1_1__bestrelpath__cache}{\+\_\+bestrelpath\+\_\+cache}}
\item 
class \mbox{\hyperlink{class__pytest_1_1main_1_1_collection_argument}{Collection\+Argument}}
\item 
class \mbox{\hyperlink{class__pytest_1_1main_1_1_dir}{Dir}}
\item 
class \mbox{\hyperlink{class__pytest_1_1main_1_1_failed}{Failed}}
\item 
class \mbox{\hyperlink{class__pytest_1_1main_1_1_f_s_hook_proxy}{FSHook\+Proxy}}
\item 
class \mbox{\hyperlink{class__pytest_1_1main_1_1_interrupted}{Interrupted}}
\item 
class \mbox{\hyperlink{class__pytest_1_1main_1_1_session}{Session}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
None \mbox{\hyperlink{namespace__pytest_1_1main_a6f49a7319d73b35b63a53b81443a7fb4}{pytest\+\_\+addoption}} (\mbox{\hyperlink{class__pytest_1_1config_1_1argparsing_1_1_parser}{Parser}} parser)
\item 
str \mbox{\hyperlink{namespace__pytest_1_1main_a65fd8be38d01875e9def6983d749a85f}{validate\+\_\+basetemp}} (str path)
\item 
int\texorpdfstring{$\vert$}{|}\mbox{\hyperlink{class__pytest_1_1config_1_1_exit_code}{Exit\+Code}} \mbox{\hyperlink{namespace__pytest_1_1main_ae3509e13637a32c732bc6250213567e1}{wrap\+\_\+session}} (\mbox{\hyperlink{class__pytest_1_1config_1_1_config}{Config}} config, Callable\mbox{[}\mbox{[}\mbox{\hyperlink{class__pytest_1_1config_1_1_config}{Config}}, \mbox{\hyperlink{class__pytest_1_1main_1_1_session}{Session}}\mbox{]}, int\texorpdfstring{$\vert$}{|}\mbox{\hyperlink{class__pytest_1_1config_1_1_exit_code}{Exit\+Code}}\texorpdfstring{$\vert$}{|}None\mbox{]} doit)
\item 
int\texorpdfstring{$\vert$}{|}\mbox{\hyperlink{class__pytest_1_1config_1_1_exit_code}{Exit\+Code}} \mbox{\hyperlink{namespace__pytest_1_1main_ad83938cff8839e1eece37d212a4f9e2a}{pytest\+\_\+cmdline\+\_\+main}} (\mbox{\hyperlink{class__pytest_1_1config_1_1_config}{Config}} config)
\item 
int\texorpdfstring{$\vert$}{|}\mbox{\hyperlink{class__pytest_1_1config_1_1_exit_code}{Exit\+Code}}\texorpdfstring{$\vert$}{|}None \mbox{\hyperlink{namespace__pytest_1_1main_ae537c0ab2e41e39e4f688aee6e86414b}{\+\_\+main}} (\mbox{\hyperlink{class__pytest_1_1config_1_1_config}{Config}} config, \mbox{\hyperlink{class__pytest_1_1main_1_1_session}{Session}} session)
\item 
None \mbox{\hyperlink{namespace__pytest_1_1main_a908ba6c279a2e95895e73e577b5d8689}{pytest\+\_\+collection}} (\mbox{\hyperlink{class__pytest_1_1main_1_1_session}{Session}} session)
\item 
bool \mbox{\hyperlink{namespace__pytest_1_1main_a5b38a407dcd9e30a60886f7b859c5f6d}{pytest\+\_\+runtestloop}} (\mbox{\hyperlink{class__pytest_1_1main_1_1_session}{Session}} session)
\item 
bool \mbox{\hyperlink{namespace__pytest_1_1main_ac7a4a6c35ceab913a5b745e00a1324d9}{\+\_\+in\+\_\+venv}} (Path path)
\item 
bool\texorpdfstring{$\vert$}{|}None \mbox{\hyperlink{namespace__pytest_1_1main_a1bf8edefeb318f973910078a639fa941}{pytest\+\_\+ignore\+\_\+collect}} (Path collection\+\_\+path, \mbox{\hyperlink{class__pytest_1_1config_1_1_config}{Config}} config)
\item 
\mbox{\hyperlink{class__pytest_1_1nodes_1_1_collector}{nodes.\+Collector}}\texorpdfstring{$\vert$}{|}None \mbox{\hyperlink{namespace__pytest_1_1main_acbdbb0e72ac5762502749b8a61ede346}{pytest\+\_\+collect\+\_\+directory}} (Path path, \mbox{\hyperlink{class__pytest_1_1nodes_1_1_collector}{nodes.\+Collector}} parent)
\item 
None \mbox{\hyperlink{namespace__pytest_1_1main_aa7b6bedce3e8c17efe21ed3af5e003bb}{pytest\+\_\+collection\+\_\+modifyitems}} (list\mbox{[}\mbox{\hyperlink{class__pytest_1_1nodes_1_1_item}{nodes.\+Item}}\mbox{]} items, \mbox{\hyperlink{class__pytest_1_1config_1_1_config}{Config}} config)
\item 
str\texorpdfstring{$\vert$}{|}None \mbox{\hyperlink{namespace__pytest_1_1main_a1e1de6d35218080b5dfd4eb3c3df0238}{search\+\_\+pypath}} (str module\+\_\+name, \texorpdfstring{$\ast$}{*}, bool consider\+\_\+namespace\+\_\+packages=False)
\item 
\mbox{\hyperlink{class__pytest_1_1main_1_1_collection_argument}{Collection\+Argument}} \mbox{\hyperlink{namespace__pytest_1_1main_a681deae444f7fb52ddc542f812ae3516}{resolve\+\_\+collection\+\_\+argument}} (Path invocation\+\_\+path, str arg, int arg\+\_\+index, \texorpdfstring{$\ast$}{*}, bool as\+\_\+pypath=False, bool consider\+\_\+namespace\+\_\+packages=False)
\item 
bool \mbox{\hyperlink{namespace__pytest_1_1main_a5a764a045a2d5cb17e3d98c82ea18602}{is\+\_\+collection\+\_\+argument\+\_\+subsumed\+\_\+by}} (\mbox{\hyperlink{class__pytest_1_1main_1_1_collection_argument}{Collection\+Argument}} arg, \mbox{\hyperlink{class__pytest_1_1main_1_1_collection_argument}{Collection\+Argument}} by)
\item 
list\mbox{[}\mbox{\hyperlink{class__pytest_1_1main_1_1_collection_argument}{Collection\+Argument}}\mbox{]} \mbox{\hyperlink{namespace__pytest_1_1main_a419998e481c0d40564b02404d10661f8}{normalize\+\_\+collection\+\_\+arguments}} (Sequence\mbox{[}\mbox{\hyperlink{class__pytest_1_1main_1_1_collection_argument}{Collection\+Argument}}\mbox{]} collection\+\_\+args)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}Core implementation of the testing process: init, session, runtest loop.\end{DoxyVerb}
 

\label{doc-func-members}
\Hypertarget{namespace__pytest_1_1main_doc-func-members}
\doxysubsection{Function Documentation}
\Hypertarget{namespace__pytest_1_1main_ac7a4a6c35ceab913a5b745e00a1324d9}\index{\_pytest.main@{\_pytest.main}!\_in\_venv@{\_in\_venv}}
\index{\_in\_venv@{\_in\_venv}!\_pytest.main@{\_pytest.main}}
\doxysubsubsection{\texorpdfstring{\_in\_venv()}{\_in\_venv()}}
{\footnotesize\ttfamily \label{namespace__pytest_1_1main_ac7a4a6c35ceab913a5b745e00a1324d9} 
 bool \+\_\+pytest.\+main.\+\_\+in\+\_\+venv (\begin{DoxyParamCaption}\item[{Path}]{path}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

\begin{DoxyVerb}Attempt to detect if ``path`` is the root of a Virtual Environment by
checking for the existence of the pyvenv.cfg file.

[https://peps.python.org/pep-0405/]

For regression protection we also check for conda environments that do not include pyenv.cfg yet --
https://github.com/conda/conda/issues/13337 is the conda issue tracking adding pyenv.cfg.

Checking for the `conda-meta/history` file per https://github.com/pytest-dev/pytest/issues/12652#issuecomment-2246336902.
\end{DoxyVerb}
 \Hypertarget{namespace__pytest_1_1main_ae537c0ab2e41e39e4f688aee6e86414b}\index{\_pytest.main@{\_pytest.main}!\_main@{\_main}}
\index{\_main@{\_main}!\_pytest.main@{\_pytest.main}}
\doxysubsubsection{\texorpdfstring{\_main()}{\_main()}}
{\footnotesize\ttfamily \label{namespace__pytest_1_1main_ae537c0ab2e41e39e4f688aee6e86414b} 
 int \texorpdfstring{$\vert$}{|} \mbox{\hyperlink{class__pytest_1_1config_1_1_exit_code}{Exit\+Code}} \texorpdfstring{$\vert$}{|} None \+\_\+pytest.\+main.\+\_\+main (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class__pytest_1_1config_1_1_config}{Config}}}]{config}{, }\item[{\mbox{\hyperlink{class__pytest_1_1main_1_1_session}{Session}}}]{session}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

\begin{DoxyVerb}Default command line protocol for initialization, session,
running tests and reporting.\end{DoxyVerb}
 \Hypertarget{namespace__pytest_1_1main_a5a764a045a2d5cb17e3d98c82ea18602}\index{\_pytest.main@{\_pytest.main}!is\_collection\_argument\_subsumed\_by@{is\_collection\_argument\_subsumed\_by}}
\index{is\_collection\_argument\_subsumed\_by@{is\_collection\_argument\_subsumed\_by}!\_pytest.main@{\_pytest.main}}
\doxysubsubsection{\texorpdfstring{is\_collection\_argument\_subsumed\_by()}{is\_collection\_argument\_subsumed\_by()}}
{\footnotesize\ttfamily \label{namespace__pytest_1_1main_a5a764a045a2d5cb17e3d98c82ea18602} 
 bool \+\_\+pytest.\+main.\+is\+\_\+collection\+\_\+argument\+\_\+subsumed\+\_\+by (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class__pytest_1_1main_1_1_collection_argument}{Collection\+Argument}}}]{arg}{, }\item[{\mbox{\hyperlink{class__pytest_1_1main_1_1_collection_argument}{Collection\+Argument}} }]{by}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Check if `arg` is subsumed (contained) by `by`.\end{DoxyVerb}
 \Hypertarget{namespace__pytest_1_1main_a419998e481c0d40564b02404d10661f8}\index{\_pytest.main@{\_pytest.main}!normalize\_collection\_arguments@{normalize\_collection\_arguments}}
\index{normalize\_collection\_arguments@{normalize\_collection\_arguments}!\_pytest.main@{\_pytest.main}}
\doxysubsubsection{\texorpdfstring{normalize\_collection\_arguments()}{normalize\_collection\_arguments()}}
{\footnotesize\ttfamily \label{namespace__pytest_1_1main_a419998e481c0d40564b02404d10661f8} 
 list\mbox{[}\mbox{\hyperlink{class__pytest_1_1main_1_1_collection_argument}{Collection\+Argument}}\mbox{]} \+\_\+pytest.\+main.\+normalize\+\_\+collection\+\_\+arguments (\begin{DoxyParamCaption}\item[{Sequence\mbox{[}\mbox{\hyperlink{class__pytest_1_1main_1_1_collection_argument}{Collection\+Argument}}\mbox{]}}]{collection\+\_\+args}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Normalize collection arguments to eliminate overlapping paths and parts.

Detects when collection arguments overlap in either paths or parts and only
keeps the shorter prefix, or the earliest argument if duplicate, preserving
order. The result is prefix-free.
\end{DoxyVerb}
 \Hypertarget{namespace__pytest_1_1main_a6f49a7319d73b35b63a53b81443a7fb4}\index{\_pytest.main@{\_pytest.main}!pytest\_addoption@{pytest\_addoption}}
\index{pytest\_addoption@{pytest\_addoption}!\_pytest.main@{\_pytest.main}}
\doxysubsubsection{\texorpdfstring{pytest\_addoption()}{pytest\_addoption()}}
{\footnotesize\ttfamily \label{namespace__pytest_1_1main_a6f49a7319d73b35b63a53b81443a7fb4} 
 None \+\_\+pytest.\+main.\+pytest\+\_\+addoption (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class__pytest_1_1config_1_1argparsing_1_1_parser}{Parser}}}]{parser}{}\end{DoxyParamCaption})}

\Hypertarget{namespace__pytest_1_1main_ad83938cff8839e1eece37d212a4f9e2a}\index{\_pytest.main@{\_pytest.main}!pytest\_cmdline\_main@{pytest\_cmdline\_main}}
\index{pytest\_cmdline\_main@{pytest\_cmdline\_main}!\_pytest.main@{\_pytest.main}}
\doxysubsubsection{\texorpdfstring{pytest\_cmdline\_main()}{pytest\_cmdline\_main()}}
{\footnotesize\ttfamily \label{namespace__pytest_1_1main_ad83938cff8839e1eece37d212a4f9e2a} 
 int \texorpdfstring{$\vert$}{|} \mbox{\hyperlink{class__pytest_1_1config_1_1_exit_code}{Exit\+Code}} \+\_\+pytest.\+main.\+pytest\+\_\+cmdline\+\_\+main (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class__pytest_1_1config_1_1_config}{Config}}}]{config}{}\end{DoxyParamCaption})}

\Hypertarget{namespace__pytest_1_1main_acbdbb0e72ac5762502749b8a61ede346}\index{\_pytest.main@{\_pytest.main}!pytest\_collect\_directory@{pytest\_collect\_directory}}
\index{pytest\_collect\_directory@{pytest\_collect\_directory}!\_pytest.main@{\_pytest.main}}
\doxysubsubsection{\texorpdfstring{pytest\_collect\_directory()}{pytest\_collect\_directory()}}
{\footnotesize\ttfamily \label{namespace__pytest_1_1main_acbdbb0e72ac5762502749b8a61ede346} 
 \mbox{\hyperlink{class__pytest_1_1nodes_1_1_collector}{nodes.\+Collector}} \texorpdfstring{$\vert$}{|} None \+\_\+pytest.\+main.\+pytest\+\_\+collect\+\_\+directory (\begin{DoxyParamCaption}\item[{Path}]{path}{, }\item[{\mbox{\hyperlink{class__pytest_1_1nodes_1_1_collector}{nodes.\+Collector}} }]{parent}{}\end{DoxyParamCaption})}

\Hypertarget{namespace__pytest_1_1main_a908ba6c279a2e95895e73e577b5d8689}\index{\_pytest.main@{\_pytest.main}!pytest\_collection@{pytest\_collection}}
\index{pytest\_collection@{pytest\_collection}!\_pytest.main@{\_pytest.main}}
\doxysubsubsection{\texorpdfstring{pytest\_collection()}{pytest\_collection()}}
{\footnotesize\ttfamily \label{namespace__pytest_1_1main_a908ba6c279a2e95895e73e577b5d8689} 
 None \+\_\+pytest.\+main.\+pytest\+\_\+collection (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class__pytest_1_1main_1_1_session}{Session}}}]{session}{}\end{DoxyParamCaption})}

\Hypertarget{namespace__pytest_1_1main_aa7b6bedce3e8c17efe21ed3af5e003bb}\index{\_pytest.main@{\_pytest.main}!pytest\_collection\_modifyitems@{pytest\_collection\_modifyitems}}
\index{pytest\_collection\_modifyitems@{pytest\_collection\_modifyitems}!\_pytest.main@{\_pytest.main}}
\doxysubsubsection{\texorpdfstring{pytest\_collection\_modifyitems()}{pytest\_collection\_modifyitems()}}
{\footnotesize\ttfamily \label{namespace__pytest_1_1main_aa7b6bedce3e8c17efe21ed3af5e003bb} 
 None \+\_\+pytest.\+main.\+pytest\+\_\+collection\+\_\+modifyitems (\begin{DoxyParamCaption}\item[{list\mbox{[}\mbox{\hyperlink{class__pytest_1_1nodes_1_1_item}{nodes.\+Item}}\mbox{]}}]{items}{, }\item[{\mbox{\hyperlink{class__pytest_1_1config_1_1_config}{Config}}}]{config}{}\end{DoxyParamCaption})}

\Hypertarget{namespace__pytest_1_1main_a1bf8edefeb318f973910078a639fa941}\index{\_pytest.main@{\_pytest.main}!pytest\_ignore\_collect@{pytest\_ignore\_collect}}
\index{pytest\_ignore\_collect@{pytest\_ignore\_collect}!\_pytest.main@{\_pytest.main}}
\doxysubsubsection{\texorpdfstring{pytest\_ignore\_collect()}{pytest\_ignore\_collect()}}
{\footnotesize\ttfamily \label{namespace__pytest_1_1main_a1bf8edefeb318f973910078a639fa941} 
 bool \texorpdfstring{$\vert$}{|} None \+\_\+pytest.\+main.\+pytest\+\_\+ignore\+\_\+collect (\begin{DoxyParamCaption}\item[{Path}]{collection\+\_\+path}{, }\item[{\mbox{\hyperlink{class__pytest_1_1config_1_1_config}{Config}}}]{config}{}\end{DoxyParamCaption})}

\Hypertarget{namespace__pytest_1_1main_a5b38a407dcd9e30a60886f7b859c5f6d}\index{\_pytest.main@{\_pytest.main}!pytest\_runtestloop@{pytest\_runtestloop}}
\index{pytest\_runtestloop@{pytest\_runtestloop}!\_pytest.main@{\_pytest.main}}
\doxysubsubsection{\texorpdfstring{pytest\_runtestloop()}{pytest\_runtestloop()}}
{\footnotesize\ttfamily \label{namespace__pytest_1_1main_a5b38a407dcd9e30a60886f7b859c5f6d} 
 bool \+\_\+pytest.\+main.\+pytest\+\_\+runtestloop (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class__pytest_1_1main_1_1_session}{Session}}}]{session}{}\end{DoxyParamCaption})}

\Hypertarget{namespace__pytest_1_1main_a681deae444f7fb52ddc542f812ae3516}\index{\_pytest.main@{\_pytest.main}!resolve\_collection\_argument@{resolve\_collection\_argument}}
\index{resolve\_collection\_argument@{resolve\_collection\_argument}!\_pytest.main@{\_pytest.main}}
\doxysubsubsection{\texorpdfstring{resolve\_collection\_argument()}{resolve\_collection\_argument()}}
{\footnotesize\ttfamily \label{namespace__pytest_1_1main_a681deae444f7fb52ddc542f812ae3516} 
 \mbox{\hyperlink{class__pytest_1_1main_1_1_collection_argument}{Collection\+Argument}} \+\_\+pytest.\+main.\+resolve\+\_\+collection\+\_\+argument (\begin{DoxyParamCaption}\item[{Path}]{invocation\+\_\+path}{, }\item[{str}]{arg}{, }\item[{int}]{arg\+\_\+index}{, }\item[{\texorpdfstring{$\ast$}{*}}]{}{, }\item[{bool }]{as\+\_\+pypath}{ = {\ttfamily False}, }\item[{bool }]{consider\+\_\+namespace\+\_\+packages}{ = {\ttfamily False}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Parse path arguments optionally containing selection parts and return (fspath, names).

Command-line arguments can point to files and/or directories, and optionally contain
parts for specific tests selection, for example:

    "pkg/tests/test_foo.py::TestClass::test_foo"

This function ensures the path exists, and returns a resolved `CollectionArgument`:

    CollectionArgument(
        path=Path("/full/path/to/pkg/tests/test_foo.py"),
        parts=["TestClass", "test_foo"],
        module_name=None,
    )

When as_pypath is True, expects that the command-line argument actually contains
module paths instead of file-system paths:

    "pkg.tests.test_foo::TestClass::test_foo[a,b]"

In which case we search sys.path for a matching module, and then return the *path* to the
found module, which may look like this:

    CollectionArgument(
        path=Path("/home/u/myvenv/lib/site-packages/pkg/tests/test_foo.py"),
        parts=["TestClass", "test_foo"],
        parametrization="[a,b]",
        module_name="pkg.tests.test_foo",
    )

If the path doesn't exist, raise UsageError.
If the path is a directory and selection parts are present, raise UsageError.
\end{DoxyVerb}
 \Hypertarget{namespace__pytest_1_1main_a1e1de6d35218080b5dfd4eb3c3df0238}\index{\_pytest.main@{\_pytest.main}!search\_pypath@{search\_pypath}}
\index{search\_pypath@{search\_pypath}!\_pytest.main@{\_pytest.main}}
\doxysubsubsection{\texorpdfstring{search\_pypath()}{search\_pypath()}}
{\footnotesize\ttfamily \label{namespace__pytest_1_1main_a1e1de6d35218080b5dfd4eb3c3df0238} 
 str \texorpdfstring{$\vert$}{|} None \+\_\+pytest.\+main.\+search\+\_\+pypath (\begin{DoxyParamCaption}\item[{str}]{module\+\_\+name}{, }\item[{\texorpdfstring{$\ast$}{*}}]{}{, }\item[{bool }]{consider\+\_\+namespace\+\_\+packages}{ = {\ttfamily False}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Search sys.path for the given a dotted module name, and return its file
system path if found.\end{DoxyVerb}
 \Hypertarget{namespace__pytest_1_1main_a65fd8be38d01875e9def6983d749a85f}\index{\_pytest.main@{\_pytest.main}!validate\_basetemp@{validate\_basetemp}}
\index{validate\_basetemp@{validate\_basetemp}!\_pytest.main@{\_pytest.main}}
\doxysubsubsection{\texorpdfstring{validate\_basetemp()}{validate\_basetemp()}}
{\footnotesize\ttfamily \label{namespace__pytest_1_1main_a65fd8be38d01875e9def6983d749a85f} 
 str \+\_\+pytest.\+main.\+validate\+\_\+basetemp (\begin{DoxyParamCaption}\item[{str}]{path}{}\end{DoxyParamCaption})}

\Hypertarget{namespace__pytest_1_1main_ae3509e13637a32c732bc6250213567e1}\index{\_pytest.main@{\_pytest.main}!wrap\_session@{wrap\_session}}
\index{wrap\_session@{wrap\_session}!\_pytest.main@{\_pytest.main}}
\doxysubsubsection{\texorpdfstring{wrap\_session()}{wrap\_session()}}
{\footnotesize\ttfamily \label{namespace__pytest_1_1main_ae3509e13637a32c732bc6250213567e1} 
 int \texorpdfstring{$\vert$}{|} \mbox{\hyperlink{class__pytest_1_1config_1_1_exit_code}{Exit\+Code}} \+\_\+pytest.\+main.\+wrap\+\_\+session (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class__pytest_1_1config_1_1_config}{Config}}}]{config}{, }\item[{Callable\mbox{[}\mbox{[}\mbox{\hyperlink{class__pytest_1_1config_1_1_config}{Config}}, \mbox{\hyperlink{class__pytest_1_1main_1_1_session}{Session}}\mbox{]}, int \texorpdfstring{$\vert$}{|} \mbox{\hyperlink{class__pytest_1_1config_1_1_exit_code}{Exit\+Code}} \texorpdfstring{$\vert$}{|} None\mbox{]} }]{doit}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Skeleton command line program.\end{DoxyVerb}
 